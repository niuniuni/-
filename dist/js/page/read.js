"use strict";define(["jquery","template","base64"],function(a,i){var c=window.localStorage,o=c.getItem("fontSize")||16,t=a(".book-cont"),n=a(".book-mask"),s=a(".menu-dialog");t.css("font-size",o+"px");var e=c.getItem("chapter_id")||1,l=null;function r(){c.setItem("chapter_id",e),a.ajax({url:"/book/reader-list?article="+e,dataType:"json",success:function(o){var n,c,t=o.jsonp;n=t,(c=document.createElement("script")).src=n,window.duokan_fiction_chapter=function(o){var o=JSON.parse(a.base64().decode(o));a(".book-cont").empty(),i(a(".readCont").html(),o,".book-cont");var n=l.length;a(".f_top_num").html(e+"/"+n),document.head.removeChild(c)},document.head.appendChild(c)}})}a.ajax({url:"/book/menu-list",dataType:"json",async:!1,success:function(o){l=o.item.toc}}),r(),t.on("click",function(){n.show()}),n.on("click",function(){n.hide()}),a(".menu-btn").on("click",function(o){o.stopPropagation(),i(a(".menulist").html(),{list:l},".menu-dialog ul"),s.addClass("show")}),a(".menu-dialog").on("click","li",function(){e=a(this).data("id"),r(),s.removeClass("show")}),a(".prev-btn").on("click",function(o){if(o.stopPropagation(),--e<=0)return!1;r()}),a(".next-btn").on("click",function(o){if(o.stopPropagation(),++e>l.length)return!1;r()}),a(".back").on("click",function(){a(".menu-dialog ul").empty(),s.removeClass("show")});var u=!0;function k(o){var n=parseInt(t.css("font-size"));t.css("font-size",n+o),c.setItem("fontSize",n+o)}a(".font-btn").on("click",function(o){o.stopPropagation(),u?(a(".font-dialog").show(),u=!1):(a(".font-dialog").hide(),u=!0)}),a(".big-btn").on("click",function(o){o.stopPropagation(),k(2)}),a(".samll-btn").on("click",function(o){o.stopPropagation(),k(-2)}),a(".back-color").on("click",function(o){o.stopPropagation(),u?(a(".book-cont").css("background","#0f1410"),a(".book-cont").css("color","#4e534f"),a(this).html("夜间"),u=!1):(a(".book-cont").css("background","#f7eee5"),a(".book-cont").css("color","#333"),a(this).html("白天"),u=!0)}),a(".back-color1").on("click",function(o){o.stopPropagation(),a(".book-cont").css("background","#f7eee5")}),a(".back-color2").on("click",function(o){o.stopPropagation(),a(".book-cont").css("background","#e9dfc7")}),a(".back-color3").on("click",function(o){o.stopPropagation(),a(".book-cont").css("background","#a4a4a4")}),a(".back-color4").on("click",function(o){o.stopPropagation(),a(".book-cont").css("background","#cdefce")}),a(".back-color5").on("click",function(o){o.stopPropagation(),a(".book-cont").css("background","#283548"),a(".book-cont").css("color","#7685a2")}),a(".back-color6").on("click",function(o){o.stopPropagation(),a(".book-cont").css("background","#0f1410"),a(".book-cont").css("color","#4e534f")})});